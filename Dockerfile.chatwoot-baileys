FROM chatwoot/chatwoot:v4.1.0

# Copy our custom Baileys provider
COPY app/services/whatsapp/providers/baileys_service.rb /app/app/services/whatsapp/providers/

# Copy updated WhatsApp model with Baileys support
COPY app/models/channel/whatsapp.rb /app/app/models/channel/

# Copy updated i18n files (backend changes only)
COPY app/javascript/dashboard/i18n/locale/pt_BR/inboxMgmt.json /app/app/javascript/dashboard/i18n/locale/pt_BR/
COPY app/javascript/dashboard/i18n/locale/en/inboxMgmt.json /app/app/javascript/dashboard/i18n/locale/en/

# Set environment variables for Baileys
ENV BAILEYS_PROVIDER_DEFAULT_URL=http://baileys-api:3025
ENV BAILEYS_PROVIDER_USE_INTERNAL_HOST_URL=true

# Use the original entrypoint
ENTRYPOINT ["docker/entrypoints/rails.sh"] 